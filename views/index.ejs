<!DOCTYPE html>
<html lang="es">
	<% include partials/head %>
    <body>
    	<main>
	    	<div class="container-fluid">
	    		<div class="row">
	    			<div class="col-md-12">
	    				<h1>Dashboard de Proyectos</h1>
	    			</div>
	    		</div>
	    		<div class="row">
	    			<div class="col-md-12">
	    				<div class="form-group">
	    					<label for="proyecto">Proyecto:</label>
	    					<select class="select" id="proyecto">
	    						<option disabled selected="">Escoge un proyecto...</option>
	    					</select>
	    				</div>
	    			</div>
	    		</div>
	    		<div class="row">
	    			<div class="col-md-2">
	    				<!-- Botón -->
	    				<button type="button" class="btn btn-default btn-lg" data-toggle="modal" data-target="#newTask">
	    				  <span class="dash-folder-plus"></span> Agregar Tarea
	    				</button>
    					<!-- Modal -->
    					<div class="modal fade" id="newTask" tabindex="-1" role="dialog" aria-labelledby="newTaskLabel">
    					  <div class="modal-dialog" role="document">
    					    <div class="modal-content">
    					      <div class="modal-header">
    					        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
    					        <h4 class="modal-title" id="newTaskLabel">Crear nueva tarea</h4>
    					      </div>
    					      <div class="modal-body">
    					      	<form id="task-form" class="form-horizontal" action="/" method="post">
    					      		<div class="form-group">
    					      			<label for="title" class="col-sm-2 control-label">Título</label>
    					      			<div class="col-sm-10">
    					      				<input type="text" class="form-control" name="title" id="title">
    					      			</div>
    					      		</div>
    					      		<div class="form-group">
    					      			<label for="desc" class="col-sm-2 control-label">Descripción</label>
    					      			<div class="col-sm-10">
   	    					      			<textarea class="form-control" rows="3" id="descrip" name="descrip"></textarea>
    					      			</div>
    					      		</div>
    					      		<div class="form-group">
    					      			<label for="resp" class="col-sm-2 control-label">Responsable</label>
    					      			<div class="col-sm-10">
    					      				<input type="text" class="form-control" name="resp" id="resp">
    					      			</div>
    					      		</div>
    					      		<div class="form-group">
    					      			<label for="state" class="col-sm-2 control-label">Estado</label>
    					      			<div class="col-sm-10">
    					      				<select class="form-control" id="state" name="state" disabled>
    					      				  <option value="initial" selected>Inicial</option>
    					      				</select>
    					      			</div>
    					      		</div>
    					      	</form>
    					      </div>
    					      <div class="modal-footer">
    					        <input type="submit" form="task-form" class="btn btn-success" value="Crear" onclick="agregarTarea();">
    					        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
    					      </div>
    					    </div>
    					  </div>
    					</div>
	    			</div>
	    		</div>
	    		<div class="row pt-20 text-center">
	    			<div class="col-md-4">
	    				<div class="well">
	    					<h4 class="bold">Inicial</h4>
	    					<div id="estadoInicial"></div>
	    				</div>
	    			</div>
	    			<div class="col-md-4">
	    				<div class="well">
	    					<h4 class="bold">En desarrollo</h4>
	    					<div id="estadoEnDesarrollo"></div>
	    				</div>
	    			</div>
	    			<div class="col-md-4">
	    				<div class="well">
	    					<h4 class="bold">Finalizadas</h4>
	    					<div id="estadoFinalizadas"></div>
	    				</div>
	    			</div>
	    		</div>
	    	</div>

	    	<div id="no-drop" class="draggable drag-drop"> #no-drop </div>

<div id="yes-drop" class="draggable drag-drop"> #yes-drop </div>

<div id="outer-dropzone" class="dropzone">
  #outer-dropzone
  <div id="inner-dropzone" class="dropzone">#inner-dropzone</div>
 </div>
    	
    		
    	</main>
    	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
		<script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js" ></script>
	    <script src="bootstrap-css/js/bootstrap.min.js"></script>
	    <script src="//cdn.jsdelivr.net/interact.js/1.2.6/interact.min.js"></script>
		<script>

            $(document).ready(function(){
                cargarProyectos();

                			//* The dragging code for '.draggable' from the demo above applies to this demo as well so it doesn't have to be repeated. */

// enable draggables to be dropped into this
interact('.dropzone').dropzone({
  // only accept elements matching this CSS selector
  accept: '#yes-drop',
  // Require a 75% element overlap for a drop to be possible
  overlap: 0.75,

  // listen for drop related events:

  ondropactivate: function (event) {
    // add active dropzone feedback
    event.target.classList.add('drop-active');
  },
  ondragenter: function (event) {
    var draggableElement = event.relatedTarget,
        dropzoneElement = event.target;

    // feedback the possibility of a drop
    dropzoneElement.classList.add('drop-target');
    draggableElement.classList.add('can-drop');
    draggableElement.textContent = 'Dragged in';
  },
  ondragleave: function (event) {
    // remove the drop feedback style
    event.target.classList.remove('drop-target');
    event.relatedTarget.classList.remove('can-drop');
    event.relatedTarget.textContent = 'Dragged out';
  },
  ondrop: function (event) {
    event.relatedTarget.textContent = 'Dropped';
  },
  ondropdeactivate: function (event) {
    // remove active dropzone feedback
    event.target.classList.remove('drop-active');
    event.target.classList.remove('drop-target');
  }
});
            });

            $("#proyecto").change(function(){
                cargarTareas($(this).val());
            })

			function cargarTareas(proyectName){

			}

            function cargarProyectos(){
                $.get("/proyectos", function(data){
                    for (i=0; i<data.length; i++){
                        var nombre = data[i].nombre;
                        $("#proyecto").append("<option>"+nombre+"</option>");
                    }
                });
            }

            function eliminarTarea(){
                tarea = $("jqueryParaNombreDeTarea");
                proyecto = $("#proyecto");

			}

			$(function(){

                $("#resp").autocomplete({
                	source: function(req, resp){
                        $.ajax({
                            method: "GET",
                            url: "/users",
                            dataType: "json",
                            data: {
                                term: req.term
							},
                            success: function( data ) {
                                console.log(data)
                                resp( data );
                            }
                        });
                    }
				});
			});

            function agregarTarea(){
                data = {
                    titulo: $("#title").val(),
                    descripcion : $("#descrip").val(),
                    responsable : $("#resp").val(),
                    proyecto: $("#proyecto").val()
                }
                $.ajax({
                    type: "POST",
					url: "/tareas",
					data: data,
					success: function(){
                        alert("Tarea Creada Con Exito");
					},
					dataType: "jsonp"
				})
			}




		</script>
	    <script src="js/script.js" ></script>
    </body>
</html>